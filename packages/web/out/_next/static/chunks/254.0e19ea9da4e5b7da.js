(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[254],{1254:function(e,t,r){"use strict";r.r(t),r.d(t,{VoiceRecorderWeb:function(){return g}});var n=r(7493),o=r(2280);let i=()=>({value:!0}),a=()=>({value:!1}),c=()=>Error("MISSING_PERMISSION"),s=()=>Error("ALREADY_RECORDING"),u=()=>Error("DEVICE_CANNOT_VOICE_RECORD"),l=()=>Error("FAILED_TO_RECORD"),d=()=>Error("RECORDING_HAS_NOT_STARTED"),h=()=>Error("FAILED_TO_FETCH_RECORDING"),f=()=>Error("COULD_NOT_QUERY_PERMISSION_STATUS"),p=["audio/aac","audio/webm;codecs=opus","audio/mp4","audio/webm","audio/ogg;codecs=opus"],v=()=>new Promise(()=>void 0);class m{constructor(){this.mediaRecorder=null,this.chunks=[],this.pendingResult=v()}static async canDeviceVoiceRecord(){var e;return(null===(e=null==navigator?void 0:navigator.mediaDevices)||void 0===e?void 0:e.getUserMedia)==null||null==m.getSupportedMimeType()?a():i()}async startRecording(){if(null!=this.mediaRecorder)throw s();let e=await m.canDeviceVoiceRecord();if(!e.value)throw u();let t=await m.hasAudioRecordingPermission().catch(()=>i());if(!t.value)throw c();return navigator.mediaDevices.getUserMedia({audio:!0}).then(this.onSuccessfullyStartedRecording.bind(this)).catch(this.onFailedToStartRecording.bind(this)),i()}async stopRecording(){if(null==this.mediaRecorder)throw d();try{return this.mediaRecorder.stop(),this.mediaRecorder.stream.getTracks().forEach(e=>e.stop()),this.pendingResult}catch(e){throw h()}finally{this.prepareInstanceForNextOperation()}}static async hasAudioRecordingPermission(){return navigator.permissions.query({name:"microphone"}).then(e=>({value:"granted"===e.state})).catch(()=>{throw f()})}static async requestAudioRecordingPermission(){let e=await m.hasAudioRecordingPermission().catch(()=>a());return e.value?i():navigator.mediaDevices.getUserMedia({audio:!0}).then(()=>i()).catch(()=>a())}pauseRecording(){if(null==this.mediaRecorder)throw d();return"recording"===this.mediaRecorder.state?(this.mediaRecorder.pause(),Promise.resolve(i())):Promise.resolve(a())}resumeRecording(){if(null==this.mediaRecorder)throw d();return"paused"===this.mediaRecorder.state?(this.mediaRecorder.resume(),Promise.resolve(i())):Promise.resolve(a())}getCurrentStatus(){return null==this.mediaRecorder?Promise.resolve({status:"NONE"}):"recording"===this.mediaRecorder.state?Promise.resolve({status:"RECORDING"}):"paused"===this.mediaRecorder.state?Promise.resolve({status:"PAUSED"}):Promise.resolve({status:"NONE"})}static getSupportedMimeType(){if((null==MediaRecorder?void 0:MediaRecorder.isTypeSupported)==null)return null;let e=p.find(e=>MediaRecorder.isTypeSupported(e));return null!=e?e:null}onSuccessfullyStartedRecording(e){this.pendingResult=new Promise((t,r)=>{this.mediaRecorder=new MediaRecorder(e),this.mediaRecorder.onerror=()=>{r(l()),this.prepareInstanceForNextOperation()},this.mediaRecorder.onstop=async()=>{let e=m.getSupportedMimeType();if(null==e)r(h());else{let n=new Blob(this.chunks,{type:e}),i=await m.blobToBase64(n),a=await (0,o.Z)(n);this.prepareInstanceForNextOperation(),t({value:{recordDataBase64:i,mimeType:e,msDuration:1e3*a}})}},this.mediaRecorder.ondataavailable=e=>this.chunks.push(e.data),this.mediaRecorder.start()})}onFailedToStartRecording(){throw this.prepareInstanceForNextOperation(),l()}static blobToBase64(e){return new Promise(t=>{let r=new FileReader;r.onloadend=()=>{let e=String(r.result),n=e.split("base64,"),o=n.length>1?n[1]:e;t(o.trim())},r.readAsDataURL(e)})}prepareInstanceForNextOperation(){if(null!=this.mediaRecorder&&"recording"===this.mediaRecorder.state)try{this.mediaRecorder.stop()}catch(e){}this.pendingResult=v(),this.mediaRecorder=null,this.chunks=[]}}class g extends n.Uw{constructor(){super(...arguments),this.voiceRecorderInstance=new m}canDeviceVoiceRecord(){return m.canDeviceVoiceRecord()}hasAudioRecordingPermission(){return m.hasAudioRecordingPermission()}requestAudioRecordingPermission(){return m.requestAudioRecordingPermission()}startRecording(){return this.voiceRecorderInstance.startRecording()}stopRecording(){return this.voiceRecorderInstance.stopRecording()}pauseRecording(){return this.voiceRecorderInstance.pauseRecording()}resumeRecording(){return this.voiceRecorderInstance.resumeRecording()}getCurrentStatus(){return this.voiceRecorderInstance.getCurrentStatus()}}},2280:function(e,t,r){"use strict";var n=r(7957);t.Z=function(e){return a.apply(this,arguments)};var o=n(r(6780)),i=n(r(5877));function a(){return(a=(0,i.default)(o.default.mark(function e(t){var r,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=document.createElement("video"),n=new Promise(function(e,t){r.addEventListener("loadedmetadata",function(){r.duration===1/0?(r.currentTime=Number.MAX_SAFE_INTEGER,r.ontimeupdate=function(){r.ontimeupdate=null,e(r.duration),r.currentTime=0}):e(r.duration)}),r.onerror=function(e){return t(e.target.error)}}),r.src="string"==typeof t||t instanceof String?t:window.URL.createObjectURL(t),e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}},5877:function(e){function t(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(u){r(u);return}c.done?t(s):Promise.resolve(s).then(n,o)}e.exports=function(e){return function(){var r=this,n=arguments;return new Promise(function(o,i){var a=e.apply(r,n);function c(e){t(a,o,i,c,s,"next",e)}function s(e){t(a,o,i,c,s,"throw",e)}c(void 0)})}}},7957:function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},6780:function(e,t,r){e.exports=r(5666)},5666:function(e){var t=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(l){u=function(e,t,r){return e[t]=r}}function d(e,r,n,i){var a,c,s=Object.create((r&&r.prototype instanceof g?r:g).prototype);return o(s,"_invoke",{value:(a=new N(i||[]),c=f,function(r,o){if(c===p)throw Error("Generator is already running");if(c===v){if("throw"===r)throw o;return T()}for(a.method=r,a.arg=o;;){var i=a.delegate;if(i){var s=function e(r,n){var o=r.iterator[n.method];if(t===o){if(n.delegate=null,"throw"===n.method){if(r.iterator.return&&(n.method="return",n.arg=t,e(r,n),"throw"===n.method))return m;n.method="throw",n.arg=TypeError("The iterator does not provide a 'throw' method")}return m}var i=h(o,r.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,m;var a=i.arg;return a?a.done?(n[r.resultName]=a.value,n.next=r.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):a:(n.method="throw",n.arg=TypeError("iterator result is not an object"),n.delegate=null,m)}(i,a);if(s){if(s===m)continue;return s}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(c===f)throw c=v,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);c=p;var u=h(e,n,a);if("normal"===u.type){if(c=a.done?v:"suspendedYield",u.arg===m)continue;return{value:u.arg,done:a.done}}"throw"===u.type&&(c=v,a.method="throw",a.arg=u.arg)}})}),s}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(n){return{type:"throw",arg:n}}}e.wrap=d;var f="suspendedStart",p="executing",v="completed",m={};function g(){}function y(){}function R(){}var w={};u(w,a,function(){return this});var E=Object.getPrototypeOf,b=E&&E(E(P([])));b&&b!==r&&n.call(b,a)&&(w=b);var _=R.prototype=g.prototype=Object.create(w);function x(e){["next","throw","return"].forEach(function(t){u(e,t,function(e){return this._invoke(t,e)})})}function O(e,t){var r;o(this,"_invoke",{value:function(o,i){function a(){return new t(function(r,a){!function r(o,i,a,c){var s=h(e[o],e,i);if("throw"===s.type)c(s.arg);else{var u=s.arg,l=u.value;return l&&"object"==typeof l&&n.call(l,"__await")?t.resolve(l.__await).then(function(e){r("next",e,a,c)},function(e){r("throw",e,a,c)}):t.resolve(l).then(function(e){u.value=e,a(u)},function(e){return r("throw",e,a,c)})}}(o,i,r,a)})}return r=r?r.then(a,a):a()}})}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function P(e){if(e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}return{next:T}}function T(){return{value:t,done:!0}}return y.prototype=R,o(_,"constructor",{value:R,configurable:!0}),o(R,"constructor",{value:y,configurable:!0}),y.displayName=u(R,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,R):(e.__proto__=R,u(e,s,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},x(O.prototype),u(O.prototype,c,function(){return this}),e.AsyncIterator=O,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new O(d(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next()})},x(_),u(_,s,"Generator"),u(_,a,function(){return this}),u(_,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=P,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else if(u){if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else throw Error("try statement without catch or finally")}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return(a.type=e,a.arg=t,i)?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:P(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=t}catch(r){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}}]);